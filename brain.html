<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Brain training - Kirill Dikalin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>

<body>
  <ul class="breadcrumb">
    <a class="bread_crumb" href="index.html">Kirill Dikalin</a> / brain
  </ul>

  <h1>Число пи</h1>

  <div class="our_framework">
    <div class="section_content">
      <p class="p_on_project_pages_text">
        Тут записаны цифры в числе пи, которые я помню наизусть, чем больше, тем лучше соответственно
      </p>
      <p class="p_on_project_pages">
        1415926535 8979323846 2643383279 5028841971 6939937510 5820974944 5923078164 0628620899 8628034825 3421170679
      </p>

      <body>
        <div>
          <label for="input-field">Продолжай... 3,</label>
          <input type="text" id="input-field">
        </div>
      </body> 
      <head>
        <style>
          #input-field {
            width: 50px; /* начальная ширина поля ввода */
          }
        </style>
        <script>
            const PI = "1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679";
            const inputField = document.querySelector('#input-field');
            const digits = document.querySelector('.p_on_project_pages');

            let currentIndex = 0;

            inputField.addEventListener('input', function(event) {
                const value = event.data;
                const correctDigit = PI[currentIndex];

                if (isNaN(parseInt(value, 10)) || value !== correctDigit) {
                    const inputString = inputField.value.slice(0, -1);
                    const correctPart = `<span style="color: green">${inputString}</span>`;
                    const wrongPart = `<span style = "color: red">${correctDigit}</span>`;
                    const restPart = PI.slice(inputString.length + 1);
                    const outputString = `${correctPart}${wrongPart}${restPart}`;
                    digits.innerHTML = outputString;
                    inputField.value = inputString;
                    return;
                }

                const inputString = inputField.value;
                const correctPart = `<span style = "color: green" > ${inputString} </span>`;
                const restPart = PI.slice(inputString.length);
                const outputString = `${correctPart}${restPart}`;
                digits.innerHTML = outputString;

                currentIndex++;

                if (currentIndex === PI.length) {
                    alert('Поздравляем! Вы ввели первые 100 знаков числа Пи после запятой.');
                    inputField.disabled = true;
                }

                const span = document.createElement('span');
                span.style.fontSize = window.getComputedStyle(inputField).fontSize;
                span.style.fontFamily = window.getComputedStyle(inputField).fontFamily;
                span.textContent = inputField.value;
                document.body.appendChild(span);
                const inputWidth = span.offsetWidth + 2;
                document.body.removeChild(span);
                inputField.style.width = inputWidth + 'px';

                const piDigits = digits.textContent.replace(/\s/g, '');
                const inputDigits = inputField.value;
                let correct = true;
                let firstWrongIndex;

                for (let i = 0; i < inputDigits.length; i++) {
                    if (inputDigits[i] !== piDigits[i]) {
                        correct = false;
                        firstWrongIndex = i;
                        break;
                    }
                }
            });
        </script>        
      </head>
    </div>
  </div>
</body>
