<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="utf-8">
  <title>439. Сумма суммы делителей — Kirill Dikalin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Разбор решения задачи Project Euler 439: Сумма суммы делителей. Аналитическая теория чисел, свёртки Дирихле, функция Мёбиуса.">
  <meta property="og:title" content="439. Сумма суммы делителей — Kirill Dikalin"/>
  <meta property="og:description" content="Разбор решения задачи Project Euler 439 с использованием аналитической теории чисел."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="/euler/439.html"/>
  <link rel="canonical" href="/euler/439.html">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../euler/euler_css.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/monokai-sublime.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true
      },
      options: {
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      }
    };
  </script>
</head>

<body>
  <ul class="breadcrumb">
    <a class="bread_crumb" href="../index.html">Kirill Dikalin</a> 
    / 
    <a class="bread_crumb" href="./euler.html">Решение задач Эйлера</a>
    / 
    439
  </ul>

  <div class="our_framework">
    <div class="section_content">
      <div id="toc_container">
        <h2 id="439">Сумма суммы делителей</h2>

        <p align="justify" class="p_on_project_pages">
          Сумма делителей натурального числа – классическая арифметическая функция, изучаемая со времён Эйлера. 
          Обозначим через $\sigma(n) = \sum_{d \mid n} d$ сумму всех делителей $n$. 
          Задача Project Euler 439 требует вычислить величину $S(N)=\sum_{i=1}^N\sum_{j=1}^N \sigma(i\cdot j)$ (в условии функции $d(k)$ соответствует $\sigma(k)$). 
          Данная сумма связана с свёртками Дирихле и теоремой Дирихле о делителях. 
          В этом отчёте рассматриваются преобразования для $S(N)$, опирающиеся на классические тождества теории чисел – 
          формулы для суммы делителей, обращения Дирихле с функцией Мёбиуса, а также методы ускоренного вычисления 
          (метод гиперболы Дирихле, частичные суммы по $\sqrt{n}$ и др.). 
          Приводятся доказательства ключевых формул и проводится асимптотический анализ $S(N)$ при больших $N$ в контексте функций $\zeta$-функции Римана и распределения делителей.
        </p>

        <h3>Определения и обозначения</h3>

        <p align="justify" class="p_on_project_pages">
          Обозначим через $\tau(n) = \sum_{d \mid n} 1$ число делителей $n$ и через $\sigma(n)=\sum_{d \mid n}d$ – сумму делителей. 
          Функция $\sigma(n)$ является мультипликативной и может быть представлена как свёртка Дирихле $\sigma = \mathbf{1} * \mathrm{id}$, 
          то есть $\sigma(n)=\sum_{d|n}1\cdot (n/d)=\sum_{d|n}d$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Петер Густав Лежен Дирихле (Peter Gustav Lejeune Dirichlet, 1805–1859) — выдающийся немецкий математик, один из основателей аналитической теории чисел. 
          Ему принадлежит классическая асимптотическая формула для суммы количества делителей:
        </p>

        <p align="center">
          $$\sum_{n \le N} \tau(n) = N \ln N + (2\gamma - 1) N + O(\sqrt{N})$$
        </p>

        <p align="justify" class="p_on_project_pages">
          впервые полученная им в 1849 году (так называемая «проблема делителей Дирихле»), где $\gamma$ — постоянная Эйлера–Маскерони. 
          Также Дирихле доказал теорему о простых числах в арифметических прогрессиях, ставшую фундаментальным результатом аналитической теории чисел.
        </p>

        <p align="justify" class="p_on_project_pages">
          Метод деления области суммирования вдоль гиперболы $ij = N$, который используется в нашем отчёте для ускорения вычислений (метод гиперболы Дирихле), 
          также восходит к его работам по оценкам сумм арифметических функций.
        </p>

        <p align="justify" class="p_on_project_pages">
          Через $\mu(n)$ обозначим функцию Мёбиуса: $\mu(n)=0$, если $n$ имеет квадратный делитель; 
          $\mu(n)=1$ при $n=1$; и $\mu(n)=(-1)^k$, если $n$ есть произведение $k$ попарно различных простых чисел.
        </p>

        <p align="justify" class="p_on_project_pages">
          Функция Мёбиуса названа в честь немецкого математика Августа Фердинанда Мёбиуса (August Ferdinand Möbius, 1790–1868), 
          профессора Лейпцигского университета, наиболее известного по топологическому объекту — ленте Мёбиуса. 
          В контексте теории чисел он впервые ввёл функцию $\mu(n)$ в 1831 году при исследовании распределения делителей и обобщённых произведений Эйлера.
        </p>

        <p align="justify" class="p_on_project_pages">
          Функция $\mu(n)$ играет фундаментальную роль в аналитической теории чисел, поскольку является <strong>свёрточной</strong> обратной к тождественно единичной функции $1(n) \equiv 1$, то есть:
        </p>

        <p align="center">
          $$(1 * \mu)(n) = \sum_{d \mid n} \mu(d) = \begin{cases} 1, & n = 1, \\ 0, & n > 1 \end{cases}$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Это свойство лежит в основе <strong>формулы обращения Мёбиуса</strong>, позволяющей по значениям одной арифметической функции $f(n)$, 
          выраженной через свёртку с $1$, восстановить исходную функцию $g(n)$. 
          Именно благодаря этой формуле функция $\mu(n)$ используется для «инверсии» выражений вида $f(n) = \sum_{d \mid n} g(d)$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Например, если известно, что $f(n) = \sum_{d \mid n} g(d)$, то можно выразить $g(n)$ обратно:
        </p>

        <p align="center">
          $$g(n) = \sum_{d \mid n} \mu(d) f\left( \frac{n}{d} \right)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Такая техника — базовый инструмент в задачах обращения сумм, развёртки вложенных сумм, инверсии подсчёта и доказательства мультипликативности.
        </p>

        <p align="justify" class="p_on_project_pages">
          Более того, функция Мёбиуса — центральный объект в <strong>гипотезе Мертенса</strong> (ныне опровергнутой), которая предсказывала, 
          что сумма $M(n) = \sum_{k=1}^{n} \mu(k)$ остаётся по модулю меньше $\sqrt{n}$. 
          Свойства $\mu(n)$ тесно связаны с дзета-функцией Римана, так как:
        </p>

        <p align="center">
          $$\sum_{n=1}^{\infty} \frac{\mu(n)}{n^s} = \frac{1}{\zeta(s)}, \quad \text{при } \mathrm{Re}(s) > 1$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Это равенство означает, что функция Мёбиуса обнуляет полюса дзета-функции в мультипликативной форме, 
          отражая её глубинные связи со структурой простых чисел.
        </p>

        <p align="justify" class="p_on_project_pages">
          Таким образом, функция Мёбиуса — это не просто вспомогательный объект, а ключевой инструмент аналитической теории чисел, 
          позволяющий переходить от сумм по делителям к точным инверсиям, сокращениям и эффективным оценкам.
        </p>

        <p align="justify" class="p_on_project_pages">
          Известно, что $\mu$ является обратной к $\mathbf{1}$ по свёртке (т.е. $\mathbf{1} * \mu = \varepsilon$, где $\varepsilon(1)=1$, $\varepsilon(n)=0$ при $n>1$). 
          Для целой части используем обозначение $\lfloor x\rfloor$ (в некоторых формулах – квадратные скобки $[x]$). 
          Также далее понадобится обозначить частичную сумму функции $\sigma$: $H(x)=\sum_{n\le x}\sigma(n)$. 
          По условию задачи требуется вычислить $S(10^{11}) \bmod 10^9$.
        </p>

        <h4>Список обозначений</h4>

        <table>
          <tbody>
            <tr>
              <td>$\tau(n)$</td>
              <td>количество делителей числа $n$</td>
            </tr>
            <tr>
              <td>$\sigma(n)$</td>
              <td>сумма делителей числа $n$</td>
            </tr>
            <tr>
              <td>$\mu(n)$</td>
              <td>функция Мёбиуса</td>
            </tr>
            <tr>
              <td>$H(x)$</td>
              <td>частичная сумма $\sigma(n)$, $H(x) = \sum_{n \le x} \sigma(n)$</td>
            </tr>
            <tr>
              <td>$M(x)$</td>
              <td>функция Мертенса, $M(x) = \sum_{n \le x} \mu(n)$</td>
            </tr>
            <tr>
              <td>$\zeta(s)$</td>
              <td>дзета-функция Римана</td>
            </tr>
            <tr>
              <td>$\lfloor x \rfloor$</td>
              <td>целая часть числа $x$</td>
            </tr>
            <tr>
              <td>$\varepsilon(n)$</td>
              <td>единичная функция: $\varepsilon(1)=1$, $\varepsilon(n)=0$ при $n>1$</td>
            </tr>
          </tbody>
        </table>

        <p align="justify" class="p_on_project_pages">
          Функция $\mu$ является обратной к $\mathbf{1}$ по свёртке (т.е. $\mathbf{1} * \mu = \varepsilon$, 
          где $\varepsilon(1)=1$, $\varepsilon(n)=0$ при $n>1$). 
          Также далее понадобится обозначить частичную сумму функции $\sigma$: $H(x)=\sum_{n\le x}\sigma(n)$.
        </p>

        <h3>Тождества и преобразования для $S(N)$</h3>

        <p align="justify" class="p_on_project_pages">
          Прежде всего отметим полезную формулу для $\sigma(n)$ через двойную сумму. Имеет место тождество:
        </p>

        <p align="center">
          $$\sum_{k=1}^N k \left\lfloor \frac{N}{k}\right\rfloor = \sum_{n=1}^N \sigma(n)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Действительно, левая часть равна
        </p>

        <p align="center">
          $$\sum_{k=1}^N \sum_{m=1}^{\lfloor N/k\rfloor} k = \sum_{k=1}^N\sum_{j: kj\le N} k$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Если поменять порядок суммирования, то каждое фиксированное $n\le N$ (с разложением $n=k\cdot j$) учтётся в этой сумме столько раз, 
          сколько имеется упорядоченных пар делителей $(k,j)$ числа $n$, а именно $\sum_{k \mid n} 1 = \tau(n)$ раз. 
          При этом суммируется величина $k$ по всем делителям $k$ числа $n$, то есть получается $\sum_{k|n}k=\sigma(n)$. 
          Таким образом, сумма $\sum_{k\le N} k\lfloor N/k\rfloor$ раскладывается по $n\le N$ в сумму $\sum_{n\le N}\sigma(n)$. 
          Например, при $N=4$ левая часть равна
        </p>

        <p align="center">
          $$1\lfloor4/1\rfloor+2\lfloor4/2\rfloor+3\lfloor4/3\rfloor+4\lfloor4/4\rfloor=1\cdot4+2\cdot2+3\cdot1+4\cdot1=15$$
        </p>

        <p align="justify" class="p_on_project_pages">
          а правая –
        </p>

        <p align="center">
          $$\sigma(1)+\sigma(2)+\sigma(3)+\sigma(4)=1+3+4+7=15$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Это тождество мы будем использовать для ускоренного вычисления $\sum_{n\le x}\sigma(n)$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Перейдём к анализу
        </p>

        <p align="center">          
          $$S(N) = \sum_{i=1}^N\sum_{j=1}^N \sigma(i \cdot j)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Развернём $\sigma(i \cdot j)$ по определению:
        </p>

        <p align="center">
          $$S(N)=\sum_{i=1}^N\sum_{j=1}^N \sum_{d \mid (i j)} d$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Меняя порядок суммирования, получаем тройную сумму по $d$, $i$, $j$:
        </p>

        <p align="center">
          $$S(N)=\sum_{d=1}^{\infty} d \sum_{\substack{1\le i\le N,\,1\le j\le N\\d\,|\,i j}}1$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Внутренняя сумма есть число упорядоченных пар $(i,j)$, $1\le i,j\le N$, таких что $d$ делит $i j$. 
          Условие делимости $d \mid i j$ можно преобразовать с использованием функции $\gcd$. 
          Заметим, что $d$ делит $i j$ тогда и только тогда, когда
        </p>

        <p align="center">
          $$\frac{d}{\gcd(d,i)} \;\Big|\; j$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Это равносильно
        </p>

        <p align="center">
          $$d\cdot \frac{\gcd(i,d)}{d} \mid j$$
        </p>

        <p align="justify" class="p_on_project_pages">
          то есть
        </p>

        <p align="center">
          $$\frac{N}{\gcd(i,d)}{d}$$
        </p>

        <p align="justify" class="p_on_project_pages">
          должно быть целым (для $j\le N$). Другими словами, при фиксированных $d$ и $i$ число подходящих $j$ равно
        </p>

        <p align="center">
          $$\left\lfloor \frac{N\,\gcd(i,d)}{d}\right\rfloor$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Таким образом,
        </p>

        <p align="center">
          $$S(N)\;=\;\sum_{i=1}^N\sum_{d=1}^N \left\lfloor \frac{N\,\gcd(i,d)}{d}\right\rfloor \,d$$
        </p>

        <p align="justify" class="p_on_project_pages">
          где во второй сумме $d$ фактически ограничен $d\le iN$, но при $d> N$ слагаемые нулевые (поскольку $\lfloor N\gcd(i,d)/d\rfloor=0$ при $d>N$). 
          Теперь выполним смену порядка суммирования: суммируем прежде по $d$, а затем по $i$. 
          Внешняя сумма (по $d'$) удобно выделяется, если обозначить $d'=\gcd(i,d)$. 
          Тогда для фиксированного $d'$ мы раскладываем: $i=d' a$, $d=d' b$, где $\gcd(a,b)=1$. 
          Поскольку $i\le N$ и $d\le N$, отсюда $a\le N/d'$ и $b\le N/d'$. 
          Условие $\gcd(i,d)=d'$ эквивалентно $\gcd(a,b)=1$. 
          Кроме того, $\gcd(i,d)$ в формуле заменяется на $d'$. 
          Подстановка даёт:
        </p>

        <p align="center">
          $$S(N)\;=\;\sum_{d'=1}^N \sum_{\substack{a,\,b\ge 1\\\gcd(a,b)=1}} \Big\lfloor \frac{N\,d'}{d' b}\Big\rfloor\; d' b$$
        </p>

        <p align="justify" class="p_on_project_pages">
          где внутренние суммы по $a$ и $b$ ведутся с ограничением $a\le \lfloor N/d'\rfloor$ и $b\le a,N$ (но $b>a,N$ даёт нулевой пол). 
          Упрощая выражение:
        </p>

        <p align="center">
          $$\lfloor \frac{N d'}{d' b}\rfloor = \lfloor \frac{N}{b}\rfloor$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Таким образом, $d'$ можно вынести за скобки, а сумма уже не зависит от $d'$ внутри:
        </p>

        <p align="center">
          $$S(N)\;=\;\sum_{d'=1}^N d' \sum_{\substack{a\le N/d' \\ b\le N/d' \\ \gcd(a,b)=1}} \left\lfloor \frac{N}{b}\right\rfloor b$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Теперь воспользуемся обращением Мёбиуса. Для индикации взаимной простоты справедливо тождество:
        </p>

        <p align="center">
          $$[\gcd(a,b)=1] \;=\; \sum_{u\,|\,\gcd(a,b)} \mu(u)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          которое непосредственно выводится из свойства свёртки $\mathbf{1} * \mu = \varepsilon$. 
          Это позволяет исключить условие $\gcd(a,b)=1$ из суммирования. 
          Подставляя вместо индикатора сумму по $u$, можно поменять порядок сумм: сумма по $u$ выходит наружу, 
          а суммирование по $a,b$ распадается в произведение независимых сумм, поскольку условие $u|a$ и $u|b$ 
          распадается на два отдельных ограничения. 
          В результате после нескольких алгебраических преобразований получается компактная формула:
        </p>

        <p align="center">
          $$S(N) \;=\; \sum_{u=1}^N \mu(u)\;\Bigg(\sum_{n=1}^{\left\lfloor \frac{N}{u}\right\rfloor} \sigma(n)\Bigg)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          где во внутреннем квадрате стоит как раз частичная сумма
        </p>

        <p align="center">
          $$H(\lfloor N/u\rfloor)=\sum_{n\le N/u}\sigma(n)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Доказательство этого тождества основано на перестановке порядка суммирования и использовании множества соотношений, 
          вытекающих из мультипликативности и обращения Мёбиуса. 
          Таким образом, мы представили $S(N)$ через свёртку по $\mu$ от квадрата более простой суммирующей функции $H(x)$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Аналогично, та же формула для S(N) может быть получена из другого подхода. Пусть
        </p>

        <p align="center">
          $$f(n) = \sum_{k=1}^{n} k \cdot \left\lfloor \frac{n}{k} \right\rfloor$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Тогда известно, что
        </p>

        <p align="center">
          $$f(n) = \sum_{k=1}^{n} \sigma(k) = H(n)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Применяя свёртку с функцией Мёбиуса, получаем:
        </p>

        <p align="center">
          $$S(N) = \sum_{u=1}^{N} \mu(u) \cdot \left( f\left( \left\lfloor \frac{N}{u} \right\rfloor \right) \right)^2 = \sum_{u=1}^{N} \mu(u) \cdot \left( H\left( \left\lfloor \frac{N}{u} \right\rfloor \right) \right)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Эта формула эквивалентна полученной выше, но подводит к ней с другой стороны — через выражение $\sigma(n)$ как суммы $\sum_{k=1}^{n} k \cdot \left\lfloor n/k \right\rfloor$ и использование обращения Мёбиуса в явном виде.
        </p>

        <p align="justify" class="p_on_project_pages">
          Ещё один способ выразить S(N) — через рекуррентную формулу, построенную по аналогии с техникой включения–исключения:
        </p>

        <p align="center">
          $$S(N) = D(N)^2 - \sum_{k=1}^{v} \Big( T\left( \left\lfloor \frac{N}{k} \right\rfloor \right) - T\left( \left\lfloor \frac{N}{k+1} \right\rfloor \right) \Big) \cdot S(k) - \sum_{k=2}^{\left\lfloor \frac{N}{v+1} \right\rfloor} k \cdot S\left( \left\lfloor \frac{N}{k} \right\rfloor \right)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          где $D(N) = \sum_{n=1}^{N} \tau(n)$ — сумма количества делителей от 1 до N, а $T(x) = \frac{x(x+1)}{2}$ — x-е треугольное число.
        </p>

        <p align="justify" class="p_on_project_pages">
          Первая часть — квадрат суммы количества делителей. Вторая и третья части — поправки, отражающие пересечения при двойной сумме по $i \cdot j$. 
          Формула выражает $S(N)$ через значения $S(k)$ для меньших $k$, и потому удобна для динамического программирования по возрастанию $N$, 
          с заранее предвычисленными значениями $S(k)$ и $T(x)$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Подход особенно полезен при необходимости получения всех значений $S(k)$ до заданного $N$, а не только одного значения.
        </p>

        <p align="justify" class="p_on_project_pages">
          Альтернативно, сумма 
        </p>

        <p align="center">
          $$S(N) = \sum_{1 \le i,j \le N} \sigma(i \cdot j)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          может быть преобразована путём выделения общего делителя в парах (i, j). 
          Для этого используется тождество:
        </p>

        <p align="center">
          $$[\gcd(i, j) = 1] = \sum_{d \mid \gcd(i,j)} \mu(d)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Фиксируя общий делитель $d$, представим $i = d \cdot a$, $j = d \cdot b$, где $\gcd(a, b) = 1$. Тогда:
        </p>

        <p align="center">
          $$\sigma(i \cdot j) = \sigma(d^2 \cdot a \cdot b) = \sigma(d^2) \cdot \sigma(a \cdot b)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          а сумма по i, j сводится к тройной:
        </p>

        <p align="center">
          $$S(N) = \sum_{d=1}^{N} \sigma(d^2) \cdot \sum_{\substack{a,b \le N/d \\ \gcd(a,b)=1}} \sigma(a \cdot b)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Учитывая мультипликативность $\sigma$ и выражая ограничение $\gcd(a, b) = 1$ через Мёбиуса:
        </p>

        <p align="center">
          $$[\gcd(a,b) = 1] = \sum_{u \mid \gcd(a,b)} \mu(u)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          можно разложить внутреннюю сумму в произведение двух независимых сумм по $a$ и $b$ с ограничением $u \mid a$, $u \mid b$, 
          после чего выразить результат через квадраты частичных сумм $H(x)^2$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Итоговая формула имеет вид:
        </p>

        <p align="center">
          $$S(N) = \sum_{u=1}^{N} \mu(u) \cdot H\left( \left\lfloor \frac{N}{u} \right\rfloor \right)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          что совпадает с ранее выведенной формой, но приходит к ней через учёт взаимной простоты $i$, $j$. 
          Такой подход даёт более глубокое понимание структуры исходной суммы.
        </p>

        <p align="justify" class="p_on_project_pages">
          Отметим, что полученные формулы для $S(N)$ — это частный случай более общего метода обращения свёрток (конволюций) Дирихле.
          Функция $\sigma(n)$ выражается как $\sigma = 1 * \operatorname{id}$ — свёртка постоянной функции $1(n) \equiv 1$ и тождественной $\operatorname{id}(n) = n$. 
          Тогда двойная сумма 
        </p>

          <p align="center">
            $$S(N) = \sum_{1 \le i,j \le N} \sigma(i \cdot j)$$
          </p>

        <p align="justify" class="p_on_project_pages">
          по сути представляет собой вложенную свёртку двух независимых переменных.
        </p>

        <p align="justify" class="p_on_project_pages">
          Применяя функцию Мёбиуса как обратную к 1 по свёртке, мы инвертируем внутреннюю структуру и сводим задачу к выражению $S(N)$ через
        </p>

        <p align="center">
          $$\sum_{u=1}^{N} \mu(u) \cdot H\left( \left\lfloor \frac{N}{u} \right\rfloor \right)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          где $H(x) = \sum_{n \le x} \sigma(n)$. Это выражение удобно как для вычислений, так и для теоретического анализа.
        </p>

        <p align="justify" class="p_on_project_pages">
          В более широком контексте, метод гиперболы Дирихле — классический приём для ускоренного суммирования арифметических функций. 
          Он заключается в разбиении области суммирования вдоль гиперболы $i \cdot j = N$, что позволяет учитывать вклад «мелких» и «крупных» сомножителей отдельно. 
          Такой подход применяется, например, для сумм вида $\sum_{n \le N} f(n)$ если $f(n) = \sum_{d | n} g(d)$, и позволяет получить сложность порядка $O(\sqrt{N})$ вместо $O(N)$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Таким образом, формулы для $S(N)$, выведенные в отчёте, иллюстрируют соединение двух классических техник аналитической теории чисел: 
          обращения Мёбиуса и метода гиперболы Дирихле.
        </p>

        <h3>Алгоритмические методы вычисления</h3>

        <p align="justify" class="p_on_project_pages">
          Прямое суммирование $S(N)$ по определению требует $O(N^2)$ операций, что совершенно неосуществимо для $N$ порядка $10^{11}$. 
          Однако полученная формула через свёртку позволяет свести вычисление к суммам по порядку $N^{1/2}$ или даже меньше за счёт свойств гладкости функций $\lfloor N/x\rfloor$. 
          Используется метод гиперболы Дирихле, часто применяемый в задачах суммирования арифметических функций.
        </p>

        <p align="justify" class="p_on_project_pages">
          Для эффективного вычисления вспомогательных функций $H(x) = \sum_{n \le x} \sigma(n)$, $F(x) = \sum_{n \le x} \tau(n)$, 
          а также функции Мертенса $M(x) = \sum_{n \le x} \mu(n)$, также применяется метод гиперболы Дирихле.
          Он заключается в разбиении области суммирования на два участка:
          – «мелкие делители»: $d \le \sqrt{x}$,
          – «крупные делители»: $d > \sqrt{x}$,
          и последующем симметричном объединении их вкладов.
        </p>

        <p align="justify" class="p_on_project_pages">
          Например, для $H(x)$ справедлива формула:
        </p>

        <p align="center">
          $$H(x) = \sum_{n \le x} \sigma(n) = 2 \sum_{k=1}^{\lfloor \sqrt{x} \rfloor} k \cdot \left\lfloor \frac{x}{k} \right\rfloor - \left( \lfloor \sqrt{x} \rfloor \right)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          которая позволяет вычислить $H(x)$ за $O(\sqrt{x})$ операций, а не $O(x)$, как при прямом суммировании.
        </p>

        <p align="justify" class="p_on_project_pages">
          Аналогичный приём применяется при вычислении $M(x)$: функция Мёбиуса $\mu(n)$ сильно осциллирует, и её сумма $M(x)$ принимает значения с малыми абсолютными величинами. 
          Это позволяет сгруппировать слагаемые по одинаковым значениям $\left\lfloor \frac{x}{n} \right\rfloor$, то есть просуммировать по блокам, в которых результат постоянен.
          Такая группировка не только сокращает количество шагов до $O(\sqrt{x})$, но и даёт возможность заранее вычислить и закешировать значения $M(x)$ и $H(x)$ на необходимых отрезках, 
          используя общие структуры хранения по ключу $d = \left\lfloor N/x \right\rfloor$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Таким образом, метод гиперболы Дирихле используется не только в итоговом вычислении $S(N)$, но и в предварительной подготовке всех его слагаемых.
        </p>

        <p align="justify" class="p_on_project_pages">
          Ключевая идея – разбить область суммирования на две части вдоль гиперболы $i j = N$ так, чтобы одна часть двойной суммы 
          имела небольшой размер индекса $i$, а в другой части – небольшой размер индекса $j$. 
          В случае функции $\sigma(n)$ известно, что её частичная сумма $H(X)=\sum_{n\le X}\sigma(n)$ вычисляется за $O(\sqrt{X})$ времени методом гиперболы. 
          Для этого используют тождество, приведённое выше:
        </p>

        <p align="center">
          $$H(X)=\sum_{k\le \sqrt{X}} k \lfloor X/k\rfloor + \sum_{m\le \sqrt{X}} \lfloor X/m\rfloor^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          (две части – «низкие» и «высокие» делители). Таким образом можно быстро получить значения $H(x)$ на необходимых диапазонах.
        </p>

        <p align="justify" class="p_on_project_pages">
          Для вычисления же $S(N)$ по формуле
        </p>

        <p align="center">
          $$S(N)=\sum_{u=1}^N \mu(u)\,\big(H(\lfloor N/u\rfloor)\big)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          оптимизируют суммирование по $u$. Функция Мёбиуса $\mu(u)$ меняется не хаотично, а её сумма $M(x)=\sum_{u\le x}\mu(u)$ (функция Мертенса) 
          известна как «грубый» индикатор простоты. Хотя неизвестно, обращается ли $M(x)$ в нуль для бесконечно больших $x$, его рост намного медленнее $x$. 
          На больших интервалах $M(x)$ колеблется около нуля и удовлетворяет оценке $M(x)=O(x e^{-c\sqrt{\ln x}})$. 
          В практическом плане это позволяет эффективно суммировать $\mu(u)$ на длинных отрезках с взаимопогашением.
        </p>

        <p align="justify" class="p_on_project_pages">
          При суммировании 
        </p>

        <p align="center">
          $$\sum_{u=1}^N \mu(u) f(\lfloor N/u\rfloor)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          можно сгруппировать однотипные слагаемые с равными значениями $\lfloor N/u\rfloor$. 
          Заметим, что при $u$ из интервала $[L, R]$ значение $w=\left\lfloor \frac{N}{u}\right\rfloor$ постоянно. 
          Решая $w\le \frac{N}{u} < w+1$, находим соответствующий диапазон
        </p>

        <p align="center">
          $$u\in \big(\frac{N}{w+1}, \frac{N}{w}\big]$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Поэтому сумму по $u$ можно переписать как сумму по возможным значениям $w = \lfloor N/u\rfloor$. 
          При $w$ фиксированном внутренняя сумма по $u$ даст
        </p>

        <p align="center">
          $$\sum_{u=\lfloor N/(w+1)\rfloor+1}^{\lfloor N/w\rfloor} \mu(u) = M(\lfloor N/w\rfloor) - M(\lfloor N/(w+1)\rfloor)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          выраженную через функцию Мертенса. В нашем случае $f(x)=H(x)^2$. Таким образом
        </p>

        <p align="center">
          $$S(N)= \sum_{w=1}^{N} \Big(M\!\Big(\Big\lfloor\frac{N}{w}\Big\rfloor\Big) - M\!\Big(\Big\lfloor\frac{N}{w+1}\Big\rfloor\Big)\Big)\,\big(H(w)\big)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Прямой подсчёт $S(N)$ по определению требует $O(N^2)$ операций, поскольку речь идёт о двойной сумме по $i, j$. 
          Это делает такой подход непрактичным при больших $N$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Использование преобразований, описанных выше, позволяет существенно снизить сложность.
          Применение метода гиперболы Дирихле при вычислении вспомогательных функций $H(x)$, $F(x)$, $M(x)$ сводит их вычисление к $O(\sqrt{x})$ операций. 
          Далее, переход к суммированию по группам одинаковых значений $\left\lfloor N/u \right\rfloor$ уменьшает количество уникальных слагаемых примерно до $2\sqrt{N}$.
          В итоге, суммарная сложность вычисления $S(N)$ снижается до $O(N^{2/3})$, а при агрессивной оптимизации (в том числе с использованием решета, кэширования и SIMD) — до $O(N^{1/2 + \varepsilon})$ на практике.
        </p>

        <p align="justify" class="p_on_project_pages">
          Для ускорения реализации необходимо использовать мемоизацию: заранее вычисленные значения $H(y)$, $M(y)$ и другие вспомогательные суммы следует сохранять в хеш-таблицу или массив с индексом по $y = \left\lfloor N/u \right\rfloor$. 
          Количество таких различных значений ограничено сверху величиной $O(\sqrt{N})$, а значит, объём кэша остаётся умеренным.
        </p>

        <p align="justify" class="p_on_project_pages">
          Кроме того, все вычисления легко распараллеливаются:
          – решето Эратосфена для предварительного вычисления $\mu(n)$,
          – независимые вызовы для $H(y)$, $M(y)$,
          – финальные суммирования по блокам диапазона $u \in [1; N]$ или по $w = \lfloor N/u \rfloor$
          могут быть эффективно распределены по потокам. На практике это позволяет реализовать расчёт $S(10^{11}) \bmod 10^9$ менее чем за секунду при грамотной архитектуре кода и достаточной аппаратной поддержке.
        </p>

        <p align="justify" class="p_on_project_pages">
          На практике количество различных значений $\lfloor N/w\rfloor$ порядка $2\sqrt{N}$, поэтому данное выражение позволяет вычислять $S(N)$ за $O(N^{2/3})$ или быстрее, 
          предварительно вычислив таблицу $M(x)$ и $H(x)$ на требуемых диапазонах значений с помощью метода гиперболы. 
          Например, для $N=10^{11}$ методами аналитической числотеории удаётся найти $S(10^{11})$ по модулю $10^9$ за приемлемое время.
        </p>

        <h3>Асимптотический рост $S(N)$</h3>

        <p align="justify" class="p_on_project_pages">
          Для оценки порядка величины $S(N)$ при больших $N$ проведём асимптотический анализ. 
          Функция $\sigma(n)$ имеет средний порядок $\sim \zeta(2) \cdot n$ (где $\zeta(2)=\pi^2/6$) – это означает, что суммарно делители растут пропорционально $n^2$. 
          Более точно, известно разложение:
        </p>

        <p align="center">
          $$H(x)=\sum_{n\le x}\sigma(n)=\frac{\pi^2}{12}\,x^2 + O(x\log x)$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Используя полученную ранее формулу для $S(N)$ через $H(x)$, оценим главный член. Формально,
        </p>

        <p align="center">
          $$S(N)=\sum_{u\le N} \mu(u)\,\big(H(\lfloor N/u\rfloor)\big)^2$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Заменяя $H(y)$ на главный член $\frac{\pi^2}{12}y^2$ (игнорируя пока ошибки), получаем главную асимптотику:
        </p>

        <p align="center">
          $$S(N)\;\approx\;\frac{\pi^4}{144}\,N^4 \sum_{u=1}^N \frac{\mu(u)}{u^4}$$
        </p>

        <p align="justify" class="p_on_project_pages">
          При $N\to\infty$ ряд $\sum_{u=1}^\infty \frac{\mu(u)}{u^4}$ сходится к значению $1/\zeta(4)$, поскольку $\sum_{u\ge1}\mu(u)/u^s = 1/\zeta(s)$ при $\Re(s)>1$ (это следует из обратимости $\mu$ к $\mathbf{1}$). А $\zeta(4)=\pi^4/90$. Таким образом, получаем:
        </p>

        <p align="center">
          $$S(N) \sim \frac{\pi^4}{144}N^4 \cdot \frac{90}{\pi^4} = \frac{90}{144}N^4 = \frac{5}{8}N^4$$
        </p>

        <p align="justify" class="p_on_project_pages">
          то есть асимптотически $S(N) \sim \tfrac{5}{8} N^4$ при $N\to\infty$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Напомним, что $\zeta(2) = \pi^2 / 6$ и $\zeta(4) = \pi^4 / 90$ — эти классические результаты были найдены Леонардом Эйлером при решении так называемой «базельской проблемы» в 1735 году. 
          Именно эти значения лежат в основе коэффициента $\frac{5}{8}$ в нашей асимптотике.
        </p>

        <p align="justify" class="p_on_project_pages">
          Действительно, в выводе мы использовали равенство
        </p>

        <p align="center">
          $$\sum_{u=1}^{\infty} \frac{\mu(u)}{u^4} = \frac{1}{\zeta(4)}$$
        </p>

        <p align="justify" class="p_on_project_pages">
          а главный член $H(y) \approx \frac{\zeta(2)}{2} y^2$ даёт в квадрате $\zeta(2)^2 / 4$. Отсюда получаем:
        </p>

        <p align="center">
          $$\frac{\zeta(2)^2}{4 \, \zeta(4)} = \frac{\pi^4 / 36}{4 \cdot (\pi^4 / 90)} = \frac{90}{144} = \frac{5}{8}$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Таким образом, коэффициент $\frac{5}{8}$ в главном члене асимптотики $S(N)$ напрямую связан со значениями дзета-функции Римана при чётных аргументах и с появлением степеней $\pi^2$ и $\pi^4$ в формулах, открытых Эйлером.
        </p>

        <p align="justify" class="p_on_project_pages">
          Более строгий анализ учёта остатков показывает, что следующими членами будут порядки $N^3 \ln N$ и ниже. 
          Таким образом, $S(N)$ растёт как степень $N^4$ (что неудивительно, учитывая удвоенную суммирование по $i,j$), а постоянный коэффициент $5/8$ связан с значениями дзета-функции:
        </p>

        <p align="center">
          $$\frac{5}{8} = \frac{\zeta(2)^2}{2^2 \cdot \zeta(4)}$$
        </p>

        <p align="justify" class="p_on_project_pages">
          Численные эксперименты подтверждают, что отношение $\frac{S(N)}{N^4}$ быстро стремится к теоретическому пределу $\frac{5}{8} = 0.625$. 
          Ниже представлены значения этой величины для нескольких $N$:
        </p>

        <table>
          <thead>
            <tr>
              <th>$N$</th>
              <th>$S(N)$</th>
              <th>$S(N)/N^4$</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>$500$</td>
              <td>$\approx 3.910 \cdot 10^{10}$</td>
              <td>0.6267</td>
            </tr>
            <tr>
              <td>$10^3$</td>
              <td>563576517282</td>
              <td>0.625913</td>
            </tr>
            <tr>
              <td>$10^4$</td>
              <td>$\approx 6.25135 \cdot 10^{15}$</td>
              <td>0.625135</td>
            </tr>
            <tr>
              <td>$10^5$</td>
              <td>$\approx 6.25010 \cdot 10^{19}$</td>
              <td>0.625010</td>
            </tr>
            <tr>
              <td>$10^6$</td>
              <td>$\approx 6.25001 \cdot 10^{23}$</td>
              <td>0.6250016</td>
            </tr>
          </tbody>
        </table>

        <p align="justify" class="p_on_project_pages">
          Таким образом, при увеличении $N$ уже на 3–4 порядка отношение $S(N)/N^4$ стабилизируется с точностью до четвёртого знака после запятой. 
          Это подтверждает, что главный член $\frac{5}{8}N^4$ не только доминирует, но и приближает $S(N)$ с высокой точностью даже при умеренных значениях $N$.
        </p>

        <p align="justify" class="p_on_project_pages">
          Отметим, что средний рост $S(N)$ существенно опережает, например, рост суммы количества делителей $\sum_{i,j\le N}\tau(i j)$, 
          где главный член имел бы порядок $N^2 \ln^2 N$. В случае $\sigma(n)$ большая степень роста объясняется тем, что сама $\sigma(n)$ порядка $n$ на среднем, 
          а при суммировании по двум индексам это даёт $N^4$. Обсуждаемая асимптотика $S(n)$ свидетельствует о том, что распределение сумм делителей подчиняется закону, 
          связанному с $\zeta$-функцией Римана (поскольку коэффициент $5/8$ выражается через значения $\zeta(2)$ и $\zeta(4)$).
        </p>

        <h3>Решение</h3>

        <p align="justify" class="p_on_project_pages">
          Используя полученные формулы и методы оптимизации, можно вычислить $S(10^{11}) \bmod 10^9$ за приемлемое время. 
          Ключевые моменты реализации:
        </p>

        <ul class="p_on_project_pages">
          <li>Предварительное вычисление функции Мёбиуса $\mu(n)$ с помощью решета Эратосфена</li>
          <li>Вычисление функции Мертенса $M(x)$ методом гиперболы Дирихле</li>
          <li>Вычисление частичных сумм $H(x)$ тем же методом</li>
          <li>Группировка слагаемых по одинаковым значениям $\lfloor N/u \rfloor$</li>
          <li>Использование мемоизации для кэширования промежуточных результатов</li>
        </ul>

        <p align="justify" class="p_on_project_pages">
          Сложность алгоритма составляет $O(N^{2/3})$, а при агрессивной оптимизации – $O(N^{1/2 + \varepsilon})$ на практике.
        </p>

        <h3>Заключение</h3>

        <p align="justify" class="p_on_project_pages">
          Мы получили разложение целевой суммы $S(N)$ через более простые мультипликативные 
          функции и показали, как методы обращения Дирихле и гиперболического суммирования 
          позволяют как доказать формулы, так и реализовать их на практике. Project Euler 
          439 служит отличной иллюстрацией совмещения теоретико-числовых тождеств с 
          алгоритмическими приёмами. Используя полученное представление и вычислительные 
          оптимизации, можно вычислить $S(N)$ для больших $N$ значительно быстрее прямого 
          перебора. В частности, для $N=10^{11}$ была успешно применена комбинация 
          рассмотренных методов, позволившая найти ответ по модулю $10^9$. Эта задача 
          демонстрирует, как глубокие свойства арифметических функций (мультипликативность, 
          обратимость, связи с дзета-функцией) дают ключ к решению сложных суммировальных 
          проблем и открывают путь к эффективности вычислений на грани современных возможностей.
        </p>
      <a href="#" title="Вернуться вверх" class="buttonup"><img src="../images/up-arrow.png" alt="Вверх"></a>
      <a href="#" title="Промотать вниз" class="buttondown"><img src="../images/down-arrow.png" alt="Вниз"></a>
    </div>
  </div>

  <script src="../scripts/scrollToTop.js"></script>
  <script src="../scripts/scrollToBottom.js"></script>
</body>
</html> 